---
title: "The Success of College Basketball Teams can be predicted using several advanced team statistics"
subtitle: "A Linear Model Approach"
author: 
  - Thomas D'Onofrio
thanks: "Code and data are available at: https://github.com/TDonofrio62/Paper-On-NCAAB-Stats."
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "The March Madness college basketball tournament is one of the most exciting sports events in the world due to the intense games, unpredictable results, and the creation of brackets by millions. In this paper, data displaying each college basketball schools’ advanced team statistics was used to create a linear model with team winning percentage as the response variable, where the explanatory variables are the team statistics that play the largest factor in leading to team success. It was found that [insert statistics here once model has been created] are the most important team statistics that affect the amount of wins a team gets the most, meaning fans can use these statistics to fill out their brackets more successfully. Unfortunately, the data is slightly biased due to inconsistent scorekeeping across teams and arenas, and the racial biases of referees when calling fouls, causing some implications to the findings."
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggpubr)
library(modelsummary)
```

# Introduction

March is a very exciting time for sports fans in the US and many other countries, as it is when the NCAA Men's Division 1 Basketball Tournament, more commonly known as March Madness, is played. 68 college basketball teams go head to head, playing single elimination games until there is only one team remaining, making for some of the most intense and unpredictable sports games in the world. As a result of this, March Madness draws in a lot of viewers. 16.9 million people tuned in to the 2021 March Madness finals, making it the 2nd most viewed North American sports event only behind the Superbowl [@citeBaker]. A big reason for the massive following is that many people create brackets for the tournament, trying to predict the results. With 9.2 quintillion different bracket possibilities, all the insane upsets that nobody sees coming, and the overall chaotic nature of the tournament, creating a bracket and seeing how well you do is very appealing to both sports fans and regular people, causing all the hype around March Madness [@citeGeiling]. People put a lot of work into their brackets, comparing teams to one another and trying to figure out who has the best odds of winning. With this in mind, is there a way fans can more successfully predict which teams will have more success than others in the tournament?

In this paper, we attempt to answer this intriguing question by analyzing a variety datasets from the college basketball section of Sports Reference [@citeSR], using R [@citeR]. Datasets containing college basketball statistics from 2017 to 2020 were used, where each dataset contains many different advanced team statistics for each NCAA Division 1 school with a Men's basketball team in a specific season. The data was first graphically analyzed to determine which team statistics have a strong or noticeable relationship with how many games a team wins. These statistics were then used to create a linear model that attempts to predict winning percentage, the response variable that is being used to measure team success, where only the best and most necessary team statistics were included. As a result of this, it was determined that the following statistics [Insert statistics here once model is completed], play the most important factor in leading to team success. Thus, when filling out their brackets, fans can compare these statistics across teams to determine which teams have a good chance of going far or even winning the tournament, as opposed to just looking at wins or their seeding like many people do.

Unfortunately, there are some implications with these findings. There appears to be several aspects of bias in the datasets being used. For one, there is a lot of human error in the tracking of statistics by scorekeepers, causing certain ambiguously defined statistics in the data to be incorrectly tracked and thus skewed [@citeWilliams]. This means that data is tracked differently for each team in the league in their respective arenas, made evident by Madison Square Garden’s scorekeepers overstating the quality of shots in the NHL [@citeMcCurdy]. Thus, the data for some teams may be biased, making them look either better or worse relative to the other teams in the league. There is also unfortunate racial biases in basketball, as referees tend to show racism by calling more fouls on players with different races than them, leading to these teams scoring less points in games where this racial injustice occurs [@citeWolfers]. With more white referees in the league, teams with more white players may have team statistics skewed to make them seem better than they truly are, where teams with more players of colour will look worse because of the bias. We must be aware that our findings have been affected by these biases and as a result may not be perfectly correct. Nevertheless, a lot can be learned from the datasets which are still quite informative. 

The rest of this paper will be as follows: Section \@ref(data) goes over the datasets being used in the paper, and analyzes the data with the use of tables and graphs to see which team statistics have a relationship with winning percentage. Section \@ref(model) includes the creation of a linear regression model that uses only the most important team statistics as explanatory variables to predict winning percentage, the response variable that determines team success. Section \@ref(results) interprets the coefficients and provides a statistical analysis of the model in order to understand what is being done. Finally, Section \@ref(discussion) discusses what exactly the model and its outcome is telling us, what can be learned from it, and what implications come along with the findings.

# Data

```{r dataextract, echo = FALSE, message=FALSE}
#Load in dataset
ncaab_stats <- read_csv(here::here("inputs/data/ncaab_stats.csv"))

#Show a brief extract of the dataset by selecting 10 observations in a table
ncaab_stats %>% 
  slice(20,112,630,702,785,791,1107,1221,1493,1558) %>%
  kable(
    caption= "10 Observations from dataset of NCAA Basketball team statistics",
    col.names = c("Year", "School", "Over .500", "SRS", "Pace", "O-rating", "3pa Rate", "TS %", "TRB %", "AST %", "STL %", "BLK %", "TOV %", "ORB %"),
    booktabs = TRUE,
    linesep = "",
    align = c('c')
  ) %>% 
  kable_styling(latex_options="scale_down")
  
```

```{r srshist, echo = FALSE, message=FALSE, fig.cap= "Distribution of Simple Rating System for NCAA Basketball teams"}
ncaab_stats %>%
  ggplot(aes(x = srs)) + 
  geom_histogram(bins = 50, fill = "dodgerblue1", colour = "black") +
  theme(legend.position = "none")+
  labs(x = "Simple Rating System",
       y = "Count") +
  theme_minimal() +
  geom_vline(aes(xintercept = mean(srs)), col="red")

```

```{r scatters, echo=FALSE, fig.width=12, fig.height=12, fig.cap= "Relationship between Simple Rating System and several adcanced team statistics, coloured by whether a schools winning % was above .500 or not"}
scatter1 <- ncaab_stats %>%
  ggplot(aes(x = pace, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "Pace",
       y = "Simple Rating System",
       colour = "Over .500"
       )

scatter2 <- ncaab_stats %>%
  ggplot(aes(x = o_rtg, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "Offensive Rating",
       y = "Simple Rating System",
       colour = "Over .500"
       )

scatter3 <- ncaab_stats %>%
  ggplot(aes(x = `3pa_rate`, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "3-Point Attempt Rate",
       y = "Simple Rating System",
       colour = "Over .500"
       )

scatter4 <- ncaab_stats %>%
  ggplot(aes(x = ts_percent, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "True Shooting %",
       y = "Simple Rating System",
       colour = "Over .500"
       )

scatter5 <- ncaab_stats %>%
  ggplot(aes(x = trb_percent, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "Total Rebound %",
       y = "Simple Rating System",
       colour = "Over .500"
       )

scatter6 <- ncaab_stats %>%
  ggplot(aes(x = ast_percent, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "Assist %",
       y = "Simple Rating System",
       colour = "Over .500"
       )

scatter7 <- ncaab_stats %>%
  ggplot(aes(x = stl_percent, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "Steal %",
       y = "Simple Rating System",
       colour = "Over .500"
       )

scatter8 <- ncaab_stats %>%
  ggplot(aes(x = blk_percent, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "Block %",
       y = "Simple Rating System",
       colour = "Over .500"
       )

scatter9 <- ncaab_stats %>%
  ggplot(aes(x = tov_percent, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "Turnover %",
       y = "Simple Rating System",
       colour = "Over .500"
       )

scatter10 <- ncaab_stats %>%
  ggplot(aes(x = orb_percent, y = srs, colour = over_500)) +
  geom_point()+
  theme_bw() +
  labs(x = "Offensive Rebound %",
       y = "Simple Rating System",
       colour = "Over .500"
       )
ggarrange(scatter1, scatter2, scatter3, scatter4, scatter5, scatter6, scatter7, scatter8, scatter9, scatter10, ncol=3, nrow=4, common.legend = TRUE, legend="bottom")
```

```{r summarytab, fig.cap = "Summary statistics of important team variables"}
ncaab_stats %>% select(srs, o_rtg, ts_percent, trb_percent, tov_percent) %>% datasummary_skim()
```


```{r}
ncaab_stats %>% select(srs, o_rtg, ts_percent, trb_percent, tov_percent) %>% datasummary_correlation()
```




# Model

\begin{equation}
Pr(\theta | y) = \frac{Pr(y | \theta) Pr(\theta)}{Pr(y)}  (\#eq:bayes)
\end{equation}

Equation \@ref(eq:bayes) seems useful, eh?

Here's a dumb example of how to use some references: In paper we run our analysis in `R` [@citeR]. We also use the `tidyverse` which was written by @thereferencecanbewhatever If we were interested in baseball data then @citeLahman could be useful. 

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

# Discussion

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


